<blog-section>
    <div class="container">
        <div class="row">
            <div if="{ opts.title }" class="col s12 section-title">
                <h2>{ opts.title }</h2>
            </div>

            <div class="col s12 masonry pd-0">

                <!-- Single Blog -->
                <div each="{ post in posts }" class="col m6 s12 mgt-20">
                    <div class="col s12 blog-wrapper w-block shadow-bg pd-0 wow fadeIn animated" data-wow-duration="0.5s" data-wow-delay="0.3s" data-wow-offset="0">
                        <div class="col s12 blog-img pd-0 image-bg" data-image-bg="{ post.image }">
                            <a class="blog-date waves-effect waves-light" href="javascript:void(0);">{ post.date }</a>
                        </div>
                        <div class="col s12 blog-desc pd-30">
                            <div class="blog-title">
                                <a href="{ post.link }">{ post.title }</a>
                            </div>
                            <div class="blog-data">
                                <a href="javascript:void(0);" class="waves-effect"><span class="fa fa-user"></span>{ post.author }</a>
                            </div>
                            <div class="blog-content">
                                <p>{ post.text }</p>
                            </div>
                            <div class="blog-more">
                                <a href="{ post.link }" class="btn-custom waves-effect mgt-10 mgb-10">Read More</a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Single Blog -->

            </div>

            <div if="{ opts.max }" class="col s12 blog-all al-center">
                <a href="blog.html" class="btn-custom waves-effect">All Blog Posts</a>
            </div>
        </div>
    </div>

    <script>
        this.posts = opts.posts || [];

        // Splice posts array if a max value is provided
        if (opts.max) {
            this.posts.splice(opts.max, this.posts.length - opts.max);
        }

        // Generate posts links + clean and cut long posts text
        this.posts.forEach(function(post) {
            post.link = 'post.html?id=' + post.id;
            post.text = $('<p>' + post.text + '</p>').text().trim(); // remove all html tags and outer spaces
            if (post.text.length > 200) {
                post.text = post.text.substr(0, 200);
            }
            post.text += '...';
        });

        // TODO: add pagination support (when opts.max is not provided)
    </script>
</blog-section>